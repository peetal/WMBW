"0","rm(list = ls())"
"0",""
"0","# load in the COPE11 data with Schaefer400 parcellation scheme applied:"
"0","schaefer400_cope11 <- import(here::here('./data/wm_schaf_cope11_pe_2mm_pe_400.csv'))"
"0","# load in behavioral results (2-back, list-sorting, Pmat, picVocalb, reading_recog)"
"0","behavioral <- import(here::here('./data/HCP_behavioral_data.csv')) %>%"
"0","  select(Subject, WM_Task_2bk_Acc, ListSort_AgeAdj, PMAT24_A_CR, PicVocab_AgeAdj, ReadEng_AgeAdj)"
"0","# merge and remove na"
"0","working_df <- inner_join(schaefer400_cope11, behavioral, by = 'Subject') %>% "
"0","  na.omit()"
"0",""
"0","# subjects who had more than 20 parcels showing extreme values. "
"0","lower_threshold <- "
"0","  working_df[,2:ncol(schaefer400_cope11)] %>%"
"0","  map_dbl(~ quantile(., 0.25) - 1.5*IQR(.)) %>% unname()"
"0","upper_threshold <-  "
"0","  working_df[,2:ncol(schaefer400_cope11)] %>%"
"0","  map_dbl(~ quantile(., 0.75) + 1.5*IQR(.)) %>% unname()"
"0",""
"0","working_df_copy1 <-data.frame(working_df)"
"0","for (col in 2:ncol(schaefer400_cope11)){"
"0","  working_df_copy1[,col] <- ifelse((working_df_copy1[,col] < lower_threshold[col-1]) | (working_df_copy1[,col] > upper_threshold[col-1]), 1, 0)"
"0","}"
"0",""
"0","outlier_index_neural <- "
"0","  working_df_copy1[,1:ncol(schaefer400_cope11)] %>% "
"0","  pivot_longer(., LH_Cont_Cing_1: RH_Vis_9, names_to = ""parcel_name"",  values_to = ""value"") %>%"
"0","  filter(value == 1) %>%"
"0","  count(Subject) %>% "
"0","  filter(n > 40)"
"2","Error in count(., Subject) : object 'Subject' not found
"

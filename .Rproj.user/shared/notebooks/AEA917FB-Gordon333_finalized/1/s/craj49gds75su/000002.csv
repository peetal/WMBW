"0","rm(list = ls())"
"0",""
"0","# read in neural and behavioral data"
"0","gordon333_cope11 <- import(here::here('./data/gordon333_cope11_rm_outlier.csv'))"
"0","behavioral <- import(here::here('./data/HCP_behavioral_data.csv')) %>%"
"0","  select(Subject, WM_Task_2bk_Acc)"
"0","# join "
"0","working_df <- inner_join(gordon333_cope11, behavioral, by = 'Subject') %>% "
"0","  na.omit()"
"0",""
"0","# ------------------------------------------------------------------------------"
"0","# to identify brain network that is sensitive to within-subject variations"
"0","# ------------------------------------------------------------------------------"
"0","# do a one sample t test for each parcel to identify within network"
"0","within_ttest <- "
"0","  working_df %>%"
"0","  select(-c(Subject,WM_Task_2bk_Acc)) %>%"
"0","  map(~t.test(., mu = 0, alternative = ""two.sided""))"
"0",""
"0","# load activated parcel in the within network"
"0","load_activated_parcel_ttest <- "
"0","  within_ttest[within_ttest %>% map(~.$statistic) > 0]"
"0","load_activated_parcel <- "
"0","  load_activated_parcel_ttest[load_activated_parcel_ttest %>% map(~.$p.value) < 0.05/length(within_ttest)] %>%"
"0","  names()"
"0",""
"0","# load deactivated parcel in the within network"
"0","load_deactivated_parcel_ttest <- "
"0","  within_ttest[within_ttest %>% map(~ .$statistic) < 0]"
"0","load_deactivated_parcel <- "
"0","  load_deactivated_parcel_ttest[load_deactivated_parcel_ttest %>% map(~.$p.value) < 0.05/length(within_ttest)] %>%"
"0","  names()"
"0",""
"0","# load insensitive parcel "
"0","load_insensitive_parcel <- colnames(gordon333_cope11)[-1][! colnames(gordon333_cope11)[-1] %in% c(load_activated_parcel,load_deactivated_parcel)]"
"0",""
"0","# ------------------------------------------------------------------------------"
"0","# to identify brain network that is sensitive to between-subject variations"
"0","# ------------------------------------------------------------------------------"
"0",""
"0","# parcels activation correlates with behavioral performance (between-network)"
"0","between_cortest_list <- "
"0","  working_df %>%"
"0","  select(-c(Subject, WM_Task_2bk_Acc)) %>%"
"0","  map(~cor.test(., working_df$WM_Task_2bk_Acc))"
"0","  "
"0","# parcels that are positively correlated with behavior"
"0","beh_pos_cor_parcel_ttest <-"
"0","  between_cortest_list[between_cortest_list %>% map(~ magrittr::extract2(., 4)) > 0]"
"0","beh_pos_cor_parcel_name <-"
"0","  beh_pos_cor_parcel_ttest[beh_pos_cor_parcel_ttest %>% map(~ magrittr::extract2(., 3)) < 0.05/length(between_cortest_list)] %>%"
"0","  names()"
"0",""
"0","# parcels that are negatively correlated with behavior"
"0","beh_neg_cor_parcel_ttest <-"
"0","  between_cortest_list[between_cortest_list %>% map(~ magrittr::extract2(., 4)) < 0]"
"0","beh_neg_cor_parcel_name <-"
"0","  beh_neg_cor_parcel_ttest[beh_neg_cor_parcel_ttest %>% map(~ magrittr::extract2(., 3)) < 0.05/length(between_cortest_list)] %>%"
"0","  names()"
"0",""
"0","# --------------------------------------------------------"
"0","# Check the consistency of the directions of the effects. "
"0","# --------------------------------------------------------"
"0","# out of 137 parcels exhibiting between-subjects WM effects, how many of them also "
"0","# sensitive to within-subject difference? "
"0","# n = 136"
"0","sum(c(beh_pos_cor_parcel_name,beh_neg_cor_parcel_name)  %in% c(load_activated_parcel, load_deactivated_parcel))"
"1","[1]"
"1"," 136"
"1","
"
"0","# out of 91 parcels showing positive behavioral correlation, how many are load-activated?"
"0","# n = 87"
"0","sum(beh_pos_cor_parcel_name %in% load_activated_parcel)"
"1","[1]"
"1"," 87"
"1","
"
"0","# out of 46 parcels showing negative behavioral correaltion, how many are load-deactivated?"
"0","# n = 46"
"0","sum(beh_neg_cor_parcel_name %in% load_deactivated_parcel)"
"1","[1]"
"1"," 46"
"1","
"
